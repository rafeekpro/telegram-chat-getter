---
name: List Chats Command
status: open
created: 2025-12-29T12:52:49Z
updated: 2025-12-29T12:52:49Z
assigned_agent: .claude/agents/languages/python-backend-engineer.md
agent_context:
  framework: telethon
  language: python
  approach: async dialog iteration with rich table output
github: [Will be updated when synced to GitHub]
depends_on: [002]
parallel: true
conflicts_with: []
---

# Task: List Chats Command

## Description
Implement the `list` CLI subcommand to display all available chats/groups/channels the user has access to. Show chat name, ID, type, and message count in a formatted table.

## TDD Requirements
**This project uses Test-Driven Development. You MUST:**
1. RED: Write failing test first
2. GREEN: Write minimal code to make test pass
3. REFACTOR: Clean up code while keeping tests green

See `.claude/rules/tdd.enforcement.md` for complete requirements.

## Acceptance Criteria
- [ ] List all dialogs (chats, groups, channels)
- [ ] Display chat name, ID, and type
- [ ] Show unread count and total messages if available
- [ ] Format output as a nice table using `rich`
- [ ] Support filtering by type (--groups, --private, --channels)

## Technical Details

### CLI Usage
```bash
# List all chats
python -m telegram_getter list

# Filter by type
python -m telegram_getter list --groups
python -m telegram_getter list --private
python -m telegram_getter list --channels
```

### Example Output
```
┌─────────────────────────────────────────────────────────────┐
│                     Your Telegram Chats                      │
├──────────────┬─────────────┬──────────┬────────────────────┤
│ ID           │ Type        │ Unread   │ Name               │
├──────────────┼─────────────┼──────────┼────────────────────┤
│ 123456789    │ Private     │ 0        │ John Doe           │
│ -100987654   │ Group       │ 5        │ Work Team          │
│ -100111222   │ Channel     │ 12       │ Tech News          │
└──────────────┴─────────────┴──────────┴────────────────────┘
```

### Implementation Approach
```python
from telethon.tl.types import User, Chat, Channel

async def list_chats(client, filter_type=None):
    dialogs = await client.get_dialogs()
    chats = []
    for dialog in dialogs:
        entity = dialog.entity
        chat_type = get_chat_type(entity)
        if filter_type and chat_type != filter_type:
            continue
        chats.append({
            "id": entity.id,
            "name": dialog.name,
            "type": chat_type,
            "unread": dialog.unread_count,
        })
    return chats
```

## Dependencies
- [ ] Task 002: Authentication Module (for Telegram client connection)

## Effort Estimate
- Size: S
- Hours: 2
- Parallel: true (can run alongside task 004)

## Definition of Done
- [ ] Tests written FIRST (RED phase)
- [ ] Code implemented (GREEN phase)
- [ ] Code refactored (REFACTOR phase)
- [ ] All tests passing
- [ ] Chats displayed in formatted table
- [ ] Filtering works correctly
- [ ] Handles empty chat list gracefully
